require import AllCore IntDiv CoreMap List Distr.
from Jasmin require import JModel_x86.
import SLH64.

from Jasmin require import JLeakage.



module M = {
  var leakages : leakages_t
  
  proc test_vpmovsx_reg (p:W64.t, a:W128.t, b:W256.t) : W128.t = {
    var aux: W128.t;
    var aux_0: W256.t;
    
    var c:W128.t;
    var d:W256.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVSX_8u8_8u16 (truncateu64 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVSX_8u8_8u16 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVSX_16u8_16u16 (truncateu128 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVSX_16u8_16u16 (loadW128 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVSX_4u8_4u32 (truncateu32 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVSX_4u8_4u32 (loadW32 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVSX_8u8_8u32 (truncateu64 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVSX_8u8_8u32 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVSX_2u8_2u64 (truncateu16 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVSX_2u8_2u64 (loadW16 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVSX_4u8_4u64 (truncateu32 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVSX_4u8_4u64 (loadW32 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVSX_4u16_4u32 (truncateu64 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVSX_4u16_4u32 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVSX_8u16_8u32 (truncateu128 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVSX_8u16_8u32 (loadW128 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVSX_2u16_2u64 (truncateu32 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVSX_2u16_2u64 (loadW32 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVSX_4u16_4u64 (truncateu64 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVSX_4u16_4u64 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVSX_2u32_2u64 (truncateu64 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVSX_2u32_2u64 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVSX_4u32_4u64 (truncateu128 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVSX_4u32_4u64 (loadW128 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` (truncateu128 b));
    a <- aux;
    return (a);
  }
  
  proc test_vpmovzx_reg (p:W64.t, a:W128.t, b:W256.t) : W128.t = {
    var aux: W128.t;
    var aux_0: W256.t;
    
    var c:W128.t;
    var d:W256.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVZX_8u8_8u16 (truncateu64 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVZX_8u8_8u16 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVZX_16u8_16u16 (truncateu128 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVZX_16u8_16u16 (loadW128 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVZX_4u8_4u32 (truncateu32 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVZX_4u8_4u32 (loadW32 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVZX_8u8_8u32 (truncateu64 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVZX_8u8_8u32 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVZX_2u8_2u64 (truncateu16 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVZX_2u8_2u64 (loadW16 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVZX_4u8_4u64 (truncateu32 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVZX_4u8_4u64 (loadW32 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVZX_4u16_4u32 (truncateu64 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVZX_4u16_4u32 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVZX_8u16_8u32 (truncateu128 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVZX_8u16_8u32 (loadW128 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVZX_2u16_2u64 (truncateu32 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVZX_2u16_2u64 (loadW32 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVZX_4u16_4u64 (truncateu64 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVZX_4u16_4u64 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- VPMOVZX_2u32_2u64 (truncateu64 a);
    a <- aux;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux <- VPMOVZX_2u32_2u64 (loadW64 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    c <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` c);
    a <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- VPMOVZX_4u32_4u64 (truncateu128 b);
    b <- aux_0;
    leakages <- LeakAddr([(W64.to_uint (p + (W64.of_int 0)))]) :: leakages;
    aux_0 <- VPMOVZX_4u32_4u64 (loadW128 Glob.mem (W64.to_uint (p + (W64.of_int 0))));
    d <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (b `|` d);
    b <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (a `|` (truncateu128 b));
    a <- aux;
    return (a);
  }
}.

